---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import MediaCard from '../components/MediaCard.astro';

const allMedia = await getCollection('media');

const sortedMedia = allMedia.sort((a, b) => {
  return b.data.date.getTime() - a.data.date.getTime();
});

const mediaByType = {
  talk: sortedMedia.filter(item => item.data.type === 'talk'),
  podcast: sortedMedia.filter(item => item.data.type === 'podcast'),
  press: sortedMedia.filter(item => item.data.type === 'press'),
  interview: sortedMedia.filter(item => item.data.type === 'interview'),
  award: sortedMedia.filter(item => item.data.type === 'award'),
};

const stats = {
  talks: mediaByType.talk.length,
  podcasts: mediaByType.podcast.length,
  press: mediaByType.press.length,
  awards: mediaByType.award.length,
};
---

<BaseLayout
  title="Digital Press Room - Gavin Rozzi"
  description="Conference talks, podcast appearances, press coverage, and media highlights on civic technology, digital transformation, and government innovation."
>
  <Fragment slot="head">
    <script is:inline type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "ItemList",
      "itemListElement": sortedMedia.map((item, index) => ({
        "@type": "ListItem",
        "position": index + 1,
        "url": `${Astro.site}media/${item.slug}/`,
        "name": item.data.title
      }))
    })} />
  </Fragment>
  <section class="press-hero">
    <div class="container">
      <div class="hero-content">
        <h1 class="page-title">Digital Press Room</h1>
        <p class="page-subtitle">
          Sharing insights on civic tech, digital transformation, and building platforms for the public interest
        </p>
        <div class="press-stats">
          <a href="#conference-talks" class="stat-item">
            <span class="stat-value">{stats.talks}</span>
            <span class="stat-label">Conference Talks</span>
          </a>
          <a href="#podcast-appearances" class="stat-item">
            <span class="stat-value">{stats.podcasts}</span>
            <span class="stat-label">Podcast Episodes</span>
          </a>
          <a href="#press-coverage" class="stat-item">
            <span class="stat-value">{stats.press}</span>
            <span class="stat-label">Press Features</span>
          </a>
          <a href="#awards" class="stat-item">
            <span class="stat-value">{stats.awards}</span>
            <span class="stat-label">Awards</span>
          </a>
        </div>
      </div>
    </div>
  </section>

  {mediaByType.talk.length > 0 && (
    <section id="conference-talks" class="media-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Conference Talks & Presentations</h2>
          <p class="section-description">
            Speaking engagements at conferences, universities, and professional events on civic technology, open data, and digital government.
          </p>
        </div>
        <div class="media-grid">
          {mediaByType.talk.map(item => (
            <MediaCard
              title={item.data.title}
              summary={item.data.summary || ''}
              date={item.data.date}
              slug={item.slug}
              type={item.data.type}
              venue={item.data.venue}
              location={item.data.location}
              url={item.data.url}
              embedUrl={item.data.embedUrl}
              featured={false}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  {mediaByType.podcast.length > 0 && (
    <section id="podcast-appearances" class="media-section media-section--alt">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Podcast Appearances</h2>
          <p class="section-description">
            In-depth conversations about building civic technology, government modernization, and the intersection of policy and code.
          </p>
        </div>
        <div class="media-grid">
          {mediaByType.podcast.map(item => (
            <MediaCard
              title={item.data.title}
              summary={item.data.summary || ''}
              date={item.data.date}
              slug={item.slug}
              type={item.data.type}
              venue={item.data.venue}
              location={item.data.location}
              url={item.data.url}
              embedUrl={item.data.embedUrl}
              featured={false}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  {mediaByType.press.length > 0 && (
    <section id="press-coverage" class="media-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Press Coverage</h2>
          <p class="section-description">
            Media coverage of civic technology projects and digital government initiatives.
          </p>
        </div>
        <div class="media-grid">
          {mediaByType.press.map(item => (
            <MediaCard
              title={item.data.title}
              summary={item.data.summary || ''}
              date={item.data.date}
              slug={item.slug}
              type={item.data.type}
              venue={item.data.venue}
              location={item.data.location}
              url={item.data.url}
              embedUrl={item.data.embedUrl}
              featured={false}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  {mediaByType.award.length > 0 && (
    <section id="awards" class="media-section media-section--alt">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">Recognition & Awards</h2>
          <p class="section-description">
            Honors recognizing contributions to civic technology, journalism, and government innovation.
          </p>
        </div>
        <div class="media-grid">
          {mediaByType.award.map(item => (
            <MediaCard
              title={item.data.title}
              summary={item.data.summary || ''}
              date={item.data.date}
              slug={item.slug}
              type={item.data.type}
              venue={item.data.venue}
              location={item.data.location}
              url={item.data.url}
              embedUrl={item.data.embedUrl}
              featured={false}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <section class="contact-cta">
    <div class="container">
      <div class="cta-card">
        <h2 class="cta-title">Speaking & Media Inquiries</h2>
        <p class="cta-text">
          Available for conference talks, podcast interviews, and expert commentary on:
        </p>

        <ul class="expertise-list">
          <li>Civic technology and open data initiatives</li>
          <li>Digital transformation in government</li>
          <li>Public records and transparency policy</li>
          <li>Building technology for the public interest</li>
        </ul>

        <a href="/contact" class="cta-button">
          Get in Touch
          <svg viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .press-hero {
    padding: var(--space-12) 0 var(--space-8);
    text-align: center;
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.05) 0%, rgba(20, 184, 166, 0.05) 100%);
  }

  .hero-content {
    max-width: 900px;
    margin: 0 auto;
  }

  .page-title {
    font-size: var(--text-5xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-3);
  }

  .page-subtitle {
    font-size: var(--text-xl);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-8);
  }

  .press-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-4);
    margin-top: var(--space-8);
  }

  .stat-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    padding: var(--space-4);
    background: white;
    border: 1px solid var(--color-neutral-200);
    border-radius: var(--radius-lg);
    text-decoration: none;
    color: inherit;
    transition: all var(--transition-base);
    cursor: pointer;
  }

  .stat-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
    border-color: var(--color-primary);
  }

  .stat-value {
    font-size: var(--text-4xl);
    font-weight: var(--font-bold);
    color: var(--color-primary);
  }

  .stat-label {
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }

  .featured-section,
  .media-section {
    padding: var(--space-12) 0;
  }

  .media-section--alt {
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.02) 0%, rgba(20, 184, 166, 0.02) 100%);
  }

  .section-header {
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--space-8);
  }

  .section-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-3);
  }

  .section-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
  }

  .media-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--space-6);
  }

  .contact-cta {
    padding: var(--space-12) 0;
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.05) 0%, rgba(20, 184, 166, 0.05) 100%);
  }

  .cta-card {
    max-width: 700px;
    margin: 0 auto;
    text-align: center;
    padding: var(--space-8);
    background: white;
    border: 2px solid var(--color-primary);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
  }

  .cta-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-3);
  }

  .cta-text {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-4);
  }

  .expertise-list {
    list-style: none;
    padding: 0;
    margin: 0 0 var(--space-6);
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .expertise-list li {
    font-size: var(--text-base);
    color: var(--color-text-primary);
    line-height: var(--leading-relaxed);
    padding-left: var(--space-6);
    position: relative;
  }

  .expertise-list li::before {
    content: "â€¢";
    position: absolute;
    left: var(--space-3);
    color: var(--color-primary);
    font-weight: var(--font-bold);
    font-size: var(--text-lg);
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-6);
    background: var(--gradient-primary);
    color: white;
    border-radius: var(--radius-lg);
    font-weight: var(--font-bold);
    text-decoration: none;
    transition: all var(--transition-base);
    box-shadow: var(--shadow-md);
  }

  .cta-button:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
    gap: var(--space-3);
  }

  .cta-button svg {
    width: 20px;
    height: 20px;
  }

  @media (max-width: 820px) {
    .press-stats {
      grid-template-columns: repeat(2, 1fr);
    }

    .media-grid {
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    }
  }

  @media (max-width: 768px) {
    .page-title {
      font-size: var(--text-3xl);
    }

    .page-subtitle {
      font-size: var(--text-lg);
    }
  }

  @media (max-width: 640px) {
    .press-hero {
      padding: var(--space-8) 0 var(--space-6);
    }

    .page-title {
      font-size: var(--text-2xl);
    }

    .page-subtitle {
      font-size: var(--text-base);
    }

    .press-stats {
      grid-template-columns: 1fr;
      gap: var(--space-3);
    }

    .media-grid {
      grid-template-columns: 1fr;
      gap: var(--space-4);
    }

    .featured-section,
    .media-section,
    .contact-cta {
      padding: var(--space-8) 0;
    }

    .section-title {
      font-size: var(--text-2xl);
    }

    .section-description {
      font-size: var(--text-base);
    }

    .cta-card {
      padding: var(--space-6);
    }

    .cta-title {
      font-size: var(--text-2xl);
    }

    .cta-text {
      font-size: var(--text-base);
    }

    .expertise-list li {
      font-size: var(--text-sm);
    }
  }

  @media (max-width: 480px) {
    .press-hero {
      padding: var(--space-6) 0 var(--space-4);
    }

    .page-title {
      font-size: var(--text-xl);
    }

    .stat-value {
      font-size: var(--text-2xl);
    }

    .stat-label {
      font-size: var(--text-xs);
    }

    .cta-card {
      padding: var(--space-4);
    }

    .cta-button {
      width: 100%;
      max-width: 320px;
    }
  }
</style>
